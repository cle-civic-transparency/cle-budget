<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <script type="text/javascript" src="https://d3js.org/d3.v3.min.js"></script>
  <style>
    #chart2 {
      height: 300px;
    }

    text {
      font-family: 'Lato', sans-serif;
      font-size: 12px;
    }


    path.line {
      fill: none;
      stroke: var(--red);
      stroke-width: 3px;
    }

    .axis path,
    .axis line {
      fill: none;
      stroke: slategray;
      shape-rendering: crispEdges;
    }
  </style>
</head>

<body>

  <div id="chart2"></div>

  <script type="text/javascript">
    var parseDate = d3.time.format("%Y").parse;

    var margin = {
      left: 50,
      right: 20,
      top: 20,
      bottom: 50
    };

    var width = 900 - margin.left - margin.right;
    var height = 300 - margin.top - margin.bottom;

    var min = 0;
    var max = 0;

    var xNudge = 50;
    var yNudge = 20;

    var minDate = new Date();
    var maxDate = new Date();

    d3.csv("d3/data/line-graph-police.csv")
      .row(function(d) {
        return {
          month: parseDate(d.month),
          price: Number(d.price.trim().slice(1))
        };
      })
      .get(function(error, rows) {
        min = d3.min(rows, function(d) {
          return d.price;
        });
        max = d3.max(rows, function(d) {
          return d.price;
        });
        minDate = d3.min(rows, function(d) {
          return d.month;
        });
        maxDate = d3.max(rows, function(d) {
          return d.month;
        });


        var y = d3.scale.linear()
          .domain([min, max])
          .range([height, 0]);

        var x = d3.time.scale()
          .domain([minDate, maxDate])
          .range([0, width - 10]);

        var yAxis = d3.svg.axis()
          .orient("left")
          .scale(y);

        var xAxis = d3.svg.axis()
          .orient("bottom")
          .scale(x);

        var line = d3.svg.line()
          .x(function(d) {
            return x(d.month);
          })
          .y(function(d) {
            return y(d.price);
          })
          .interpolate("cardinal");


        var chart2 = d3.select("#chart2").append("svg").attr("id", "svg").attr("height", "100%").attr("width", "100%");
        var chartGroup = chart2.append("g").attr("class", "chartGroup").attr("transform", "translate(" + xNudge + "," + yNudge + ")");

        chartGroup.append("path")
          .attr("class", "line")
          .attr("d", function(d) {
            return line(rows);
          })


        chartGroup.append("g")
          .attr("class", "axis x")
          .attr("transform", "translate(0," + height + ")")
          .call(xAxis);

        chartGroup.append("g")
          .attr("class", "axis y")
          .call(yAxis);
      });
  </script>
</body>

</html>
